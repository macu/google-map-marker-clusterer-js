!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MarkerClusterer=e():t.MarkerClusterer=e()}(self,(function(){return(()=>{"use strict";var t={519:(t,e,o)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}o.r(e),o.d(e,{createGoogleMap:()=>l,default:()=>s,defaultIcon:()=>a,geocodeAddress:()=>f});var s=function(){function t(e,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;function r(){this.debug("initializing"),this.setData(o);var t=!0;this.map.addListener("zoom_changed",function(){if(this.debug("zoom_changed",this.map.getZoom()),null!==this.zoomInFromZoom&&this.zoomInFromZoom>=this.map.getZoom())return this.map.setZoom(this.zoomInFromZoom+1),void(this.zoomInFromZoom=null);this.zoomInFromZoom=null,t=!1,this.calculateClusters()}.bind(this)),this.map.addListener("idle",function(){this.debug("idle"),t&&this.renderMarkers(),t=!0}.bind(this)),this.map.addListener("click",function(){this.closeInfoWindow()}.bind(this))}if(n(this,t),i=i||{},this.config={clusterRadius:150,onMarkerClick:i.onMarkerClick||null,clusterIcons:i.clusterIcons||function(t){switch(Math.round(t/10)){case 0:return{icon:a("rgb(0, 204, 255)",3,20)};case 1:return{icon:a("rgb(85, 255, 0)",3.25,24)};case 2:return{icon:a("rgb(255, 217, 0)",3.5,28)};case 3:return{icon:a("rgb(255, 0, 174)",3.75,32)};default:return{icon:a("rgb(170, 0, 255)",4,37)}}},enableDebug:i.enableDebug||!1},this.debug("built for Google Maps API v3"),e instanceof google.maps.Map?this.map=e:this.map=l(e),this.data=[],this.clusters=[],this.clustersById={},this.markersById={},this.visibleInfoWindow=null,this.maxZoomService=new google.maps.MaxZoomService,this.zoomInFromZoom=null,this.map.getBounds()&&this.map.getCenter())this.debug("map ready"),r.apply(this);else{this.debug("waiting for map");var s=this.map.addListener("idle",function(){this.debug("idle"),r.apply(this),s.remove()}.bind(this))}}var e,o;return e=t,(o=[{key:"setData",value:function(t){this.debug("setData"),this.data=t||[],this.data.length?(this.zoomToBounds(this.calcBounds(this.data)),this.map.getZoom()>16&&this.map.setZoom(16)):this.map.getBounds()||this.zoomToBounds(new google.maps.LatLngBounds({lat:41.40329390690307,lng:-132.41174280543527},{lat:65.0273544712607,lng:-50.87670862574777})),this.calculateClusters()}},{key:"addData",value:function(t){this.debug("addData"),Array.isArray(t)?this.data=this.data.concat(t):this.data.push(t),this.calculateClusters()}},{key:"clearData",value:function(){this.debug("clearData"),this.data=[],this.calculateClusters()}},{key:"calculateClusters",value:function(){this.debug("calculateClusters"),this.maxZoomService.getMaxZoomAtLatLng(this.map.getCenter(),function(t){var e=!1;if("OK"===t.status&&(e=t.zoom>this.map.getZoom()),this.clusters=[],e)t:for(var o=0;o<this.data.length;o++){for(var i=c((h=this.data[o]).latlng),n=0;n<this.clusters.length;n++){var r=this.clusters[n];if(this.testPointWithinClusterRadius(r.center,i)){r.data.push(h);var s=r.data.length,a=(r.center.lat()*(s-1)+i.lat())/s,l=(r.center.lng()*(s-1)+i.lng())/s;r.center=new google.maps.LatLng(a,l);continue t}}this.clusters.push({center:i,data:[h]})}else for(o=0;o<this.data.length;o++){var h=this.data[o];this.clusters.push({center:c(h.latlng),data:[h]})}var d={};for(o=0;o<this.clusters.length;o++){if((r=this.clusters[o]).data.length>1){var f=[];for(n=0;n<r.data.length;n++)f.push(r.data[n].id);r.id="cluster-"+u(f.sort().join("-"))}else r.id=r.data[0].id;var m=this.clustersById[r.id];m&&(r.marker=m.marker),d[r.id]=r}this.clustersById=d,this.renderMarkers()}.bind(this))}},{key:"renderMarkers",value:function(){this.debug("renderMarkers");for(var t=this.map.getBounds(),e=0;e<this.clusters.length;e++){var o=this.clusters[e];if(!o.marker&&t.contains(o.center)){if(o.data.length>1){var i=void 0;if(Array.isArray(this.config.clusterIcons)){for(var n=this.config.clusterIcons.length-1;n>=0;n--)if(this.config.clusterIcons[n].min<=o.data.length){i=this.config.clusterIcons[n];break}}else{if("function"!=typeof this.config.clusterIcons)throw"Unsupported clusterIcons config";i=this.config.clusterIcons(o.data.length)}if(!i)throw"No icon config for cluster size "+o.data.length;o.marker=new google.maps.Marker({id:o.id,position:o.center,icon:i.icon,label:{text:""+o.data.length,color:i.color,fontSize:i.fontSize,fontWeight:i.fontWeight},map:this.map}),o.marker.addListener("click",function(t){this.zoomInFromZoom=this.map.getZoom(),this.zoomToBounds(this.calcBounds(this.clustersById[t].data))}.bind(this,o.id))}else o.marker=new google.maps.Marker({id:o.id,position:o.center,map:this.map}),o.marker.addListener("click",this.clickMarker.bind(this,o.marker,o.data[0]));this.debug("marker added"),this.markersById[o.id]=o.marker}}for(var r in this.markersById)this.clustersById[r]||(this.markersById[r].setMap(null),delete this.markersById[r],this.debug("marker cleared"));this.afterNextRenderCallback&&(this.afterNextRenderCallback(),this.afterNextRenderCallback=null)}},{key:"clickMarker",value:function(t,e){if(this.visibleInfoWindow&&this.visibleInfoWindow.close(),this.config.onMarkerClick){var o=this.config.onMarkerClick(e);o&&(this.visibleInfoWindow=new google.maps.InfoWindow({content:o}),this.visibleInfoWindow.addListener("closeclick",(function(){this.visibleInfoWindow=null})),this.visibleInfoWindow.open(this.map,t))}}},{key:"closeInfoWindow",value:function(){this.visibleInfoWindow&&(this.visibleInfoWindow.close(),this.visibleInfoWindow=null)}},{key:"testPointWithinClusterRadius",value:function(t,e){var o=this.map.getProjection(),i=o.fromLatLngToPoint(t),n=o.fromLatLngToPoint(e),r=Math.pow(2,-this.map.getZoom());return Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y))/r<this.config.clusterRadius}},{key:"setCenter",value:function(t){this.map.setCenter(c(t))}},{key:"calcBounds",value:function(t){for(var e=new google.maps.LatLngBounds,o=0;o<t.length;o++)e.extend(c(t[o].latlng));return e}},{key:"zoomToBounds",value:function(t){this.map.fitBounds(t),this.map.panToBounds(t)}},{key:"zoomToPosition",value:function(t,e){this.map.getZoom()<16&&this.map.setZoom(16),this.map.setCenter(c(t)),this.afterNextRenderCallback=e}},{key:"debug",value:function(){if(this.config.enableDebug){var t=["MarkerClusterer"].concat(Array.prototype.slice.call(arguments));console.debug.apply(null,t)}}}])&&r(e.prototype,o),t}();function a(t,e,o){return{path:google.maps.SymbolPath.CIRCLE,fillColor:t,fillOpacity:.75,strokeColor:t,strokeWeight:e,scale:o}}function l(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new google.maps.Map(t,{fullscreenControl:e,streetViewControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}})}function c(t){if(t instanceof google.maps.LatLng)return t;if(Array.isArray(t)&&2===t.length)return new google.maps.LatLng(t[0],t[1]);if("object"===i(t))return new google.maps.LatLng(t.lat,t.lng);throw"Unsupported latlng value"}function u(t){var e,o=0;for(e=0;e<t.length;e++)o=(o<<5)-o+t.charCodeAt(e),o|=0;return o}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var d=null;function f(t,e){if(t){if(d||(d=new google.maps.Geocoder),"string"==typeof t)t=t.trim();else if("object"===h(t))if(Array.isArray(t)){for(var o=[],i=0;i<t.length;i++){var n=t[i].trim();n&&o.push(n)}t=o.join(", ")}else{var r=(t.street||"").trim(),s=(t.city||"").trim(),a=(t.province||t.state||"").trim(),l=(t.country||"").trim(),c=(t.postcode||t.zipcode||"").trim(),u=0;t=(r?(u++,r):"")+(s?(u?", ":"")+(u++,s):"")+(a?(u?", ":"")+(u++,a):"")+(l?(u?", ":"")+(u++,l):"")+(c?(u?", ":"")+c:"")}t?d.geocode({address:t},(function(t,o){e("OK"==o&&t[0].geometry.location)})):e(null)}else e(null)}}},e={};function o(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i](n,n.exports,o),n.exports}return o.d=(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o(519)})()}));